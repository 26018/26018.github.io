---
layout: post
title: 初级链表
tags: C语言 链表
data: 2020-03-04
author: 金辉
cover: 'https://cdn.jsdelivr.net/gh/26018/img/image/星空.png'
grammar_codeLinenums: true
excerpt_separator: <!--more-->
---
<!--more-->
> 链表算是比较重要的一个知识吧   
> 慢慢来写,也不太难  

```c
#include<stdio.h>
#include<stdlib.h>
#include<string.h>

//此程序完成了 1.创建链表，2.打印链表，3.添加数据，4.释放链表

char *x = "#";

struct stu{
	char name[20];
	struct stu *next;
};

struct stu *first, *mid, *end;

void freeNode(struct stu *Pnew)      //     清除 中间变量 函数
{
	Pnew = (struct stu *)malloc(sizeof(struct stu));
	free(Pnew);
	Pnew = NULL;
}

void link()   //创建链表
{
	first = (struct stu *)malloc(sizeof(struct stu));
	mid = (struct stu *)malloc(sizeof(struct stu));

	first->next = mid;              //保留first 指针 ，使其不被其他代码改变，方便遍历链表
	while(1)
	{
		memset(mid->name,'\0',20);    //初始化数组
		printf("请输入姓名:");
		scanf("%s",&(mid->name));

		if(strcmp(mid->name,x) == 0)
			break;
		else
		{
			mid->next = (struct stu *)malloc(sizeof(struct stu));
			mid = mid->next;
		}
	}
	end = mid;
	end->next = NULL;     //end的指针域为空   防止成为野指针
	freeNode(mid);
}

void print_info()
{
	printf("\n");

	mid = (struct stu *)malloc(sizeof(struct stu));
	mid = first->next;
	while(mid != end)
	{
		printf("%d\t%s\n",mid,mid->name);
		mid = mid->next;
	}
	freeNode(mid);
}

void add()
{
	printf("\n1.在链首添加\n\n2.选择数据位置添加\n\n");
	printf("请选择：");
	int choice;
	scanf("%d",&choice);

	if(choice == 1)
	{
		printf("\n您选择了在链首添加！\n");
		mid = (struct stu *)malloc(sizeof(struct stu));			//这是一个新变量，已重新申请内存，与上面的代码无关
		if(mid != NULL)
			printf("\n内存分配成功！\n");

		mid->next = first->next;
		first->next = mid;
		printf("\n请输入姓名：");
		scanf("%s",&(mid->name));
		printf("\n数据添加成功！\n");
		freeNode(mid);
	}

	else if(choice == 2)
	{
		printf("\n您选择了选定数据位置添加！\n");
		print_info();
		printf("\n请输入列表中的名字，以便在其下添加数据：");

		struct stu *pNew = (struct stu *)malloc(sizeof(struct stu));     //用来保存添加数据的结点
		mid = (struct stu *)malloc(sizeof(struct stu));

		char Tname[20];
		memset(Tname,'\0',20);    //初始化数组
		scanf("%s",Tname);

		mid = first->next;

		while(mid)
		{
			if(strcmp(mid->name,Tname) == 0)
			{
				printf("已找到要查找的数值：%s",mid->name);
				break;
			}
			else
				mid = mid->next;
		 }
		 pNew->next = mid->next;
		 mid->next = pNew;

		printf("\n请输入姓名：");
		scanf("%s",&(pNew->name));
		printf("\n数据添加成功！\n");

		freeNode(pNew);
		freeNode(mid);
	 }
 }

void FreeNode()     //释放链表
{
	mid = (struct stu *)malloc(sizeof(struct stu));
	while(first)
	{
		mid = first;
		first = first->next;
		free(mid);
	}
}

int main()
{
	link();	   //创建的链表
	add();
	print_info();   //打印链表
	FreeNode();

	print_info();
	return 0;
}
```